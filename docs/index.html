<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Playlist AceStream</title>
  <style>
    :root {
      color-scheme: dark light;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      margin: 0;
      background: #0f172a;
      color: #e2e8f0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      padding: 1.5rem;
    }
    header {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    h1 {
      margin: 0;
      font-size: clamp(1.5rem, 3vw, 2.3rem);
    }
    .toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
    }
    input[type="search"] {
      flex: 1 1 250px;
      padding: 0.65rem 0.9rem;
      border-radius: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.65);
      color: inherit;
    }
    select {
      padding: 0.65rem 0.9rem;
      border-radius: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.65);
      color: inherit;
    }
    main {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 1.25rem;
    }
    .card {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      padding: 1rem;
      border-radius: 1rem;
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: 0 15px 25px rgba(15, 23, 42, 0.25);
      transition: transform 120ms ease, box-shadow 120ms ease;
    }
    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 18px 28px rgba(15, 23, 42, 0.3);
    }
    .card h2 {
      margin: 0;
      font-size: 1.05rem;
    }
    .meta {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      font-size: 0.8rem;
      color: #94a3b8;
    }
    .meta span {
      padding: 0.15rem 0.45rem;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.15);
    }
    .actions {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .actions a,
    .actions button {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      gap: 0.35rem;
      padding: 0.6rem 0.9rem;
      border-radius: 0.75rem;
      border: none;
      cursor: pointer;
      font-weight: 600;
      text-decoration: none;
      color: #0f172a;
      background: #38bdf8;
    }
    .actions button.copy,
    .actions button.share {
      background: rgba(148, 163, 184, 0.15);
      color: inherit;
    }
    details.player-picker {
      background: rgba(15, 23, 42, 0.35);
      border-radius: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.2);
      padding: 0.5rem;
    }
    details.player-picker summary {
      cursor: pointer;
      list-style: none;
      font-weight: 600;
      padding: 0.3rem 0.4rem;
    }
    details.player-picker summary::-webkit-details-marker {
      display: none;
    }
    .player-picker__list {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      margin: 0.5rem 0 0;
      padding: 0;
      list-style: none;
    }
    .player-picker__list a {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.5rem 0.6rem;
      border-radius: 0.55rem;
      text-decoration: none;
      color: #38bdf8;
      background: rgba(56, 189, 248, 0.12);
    }
    footer {
      font-size: 0.8rem;
      color: #64748b;
      text-align: center;
      margin-top: auto;
    }
    @media (prefers-color-scheme: light) {
      body {
        background: #f8fafc;
        color: #0f172a;
      }
      .card {
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(148, 163, 184, 0.45);
        box-shadow: 0 15px 25px rgba(100, 116, 139, 0.15);
      }
      .actions a,
      .actions button {
        color: white;
        background: #2563eb;
      }
      .actions button.copy,
      .actions button.share {
        background: rgba(148, 163, 184, 0.2);
        color: inherit;
      }
      .player-picker__list a {
        color: #2563eb;
        background: rgba(37, 99, 235, 0.12);
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Playlist AceStream</h1>
    <p>Actualizada: 2025-10-01T19:25:19.092Z</p>
    <div class="toolbar">
      <input id="search" type="search" placeholder="Buscar por nombre, grupo o ID" />
      <select id="group">
        <option value="">Todos los grupos</option>
      </select>
    </div>
  </header>
  <main id="playlist" role="list">
  </main>
  <footer>Generado desde playlist.m3u8 - Proyecto YaVale</footer>
  <script>
    const playlist = [{"title":"M. Deportes HD","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:8aba55f4f1f47def54447e845518109d797339e7"},{"title":"M. LaLiga","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:c1959a27edb0b94c5005a2dea93b7a70d4312f1c"},{"title":"F1","attributes":{"acestream-autosearch":"1","group-title":"2025"},"duration":-1,"url":"magnet:?xt=urn:btih:b0999d6facfbae2944b9c7bba442eeea9cd9d4b2"},{"title":"DAZN4","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:c21a2524a8de3e1e5b126f2677a3e993d9aa07c4"},{"title":"DAZN3","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:98fba924421aa1e4bd28e74d74a2726d0459b594"},{"title":"Alien Planeta Tierra","attributes":{"acestream-autosearch":"1"},"duration":-1,"url":"magnet:?xt=urn:btih:eb197728d8790127be4e866e7500a70f82687afd"},{"title":"Champions League","attributes":{"group-title":"futbol"},"duration":-1,"url":"acestream://06013d0c0dcdd677ae09363db1b1f93bd97589bd"},{"title":"DAZN1","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:0560234787945a17522e284c4c22bb4df29f33b0"},{"title":"DAZN2","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:c93a0d4914713db942fbb210bac467b0224c63a6"},{"title":"s","attributes":{"acestream-autosearch":"1","group-title":"deportes"},"duration":-1,"url":"magnet:?xt=urn:btih:868cf72e65093a8eb9fc4b9c78ed90c2dd7fdb7f"},{"title":"M. Golf HD","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:b715ba3d23d3dca6736ac86990efe105087c3401"},{"title":"DAZ","attributes":{"acestream-autosearch":"1","group-title":"amateur"},"duration":-1,"url":"magnet:?xt=urn:btih:61b4e295ae003dc415babbe7c7a6c37507bd4c80"},{"title":"LALIGA","attributes":{"acestream-autosearch":"1","group-title":"amateur"},"duration":-1,"url":"magnet:?xt=urn:btih:8a25653a2f774f4ae1062d38a30dcd714d304a3a"},{"title":"NBA TV [US]","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:cc3dea4f93071fed3f67be4518618cd73a6ca77a"},{"title":"Campeones 1080 elcano.top zeronet http://127.0.0.1:43110/18D6dPcsjLrjg2hhnYqKzNh2W6QtXrDwF/  https://ipfs.io/ipns/elcano.top","attributes":{"group-title":"sport"},"duration":-1,"url":"acestream://97df5b7824948972d041d8ca2a4d29c90b641bc9"},{"title":"M. Liga de Campeones","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:8c1c3eae077f3a786ed2f0a426197ea93fdf7373"},{"title":"M. Liga de Campeones 2","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:cc3d749cfd30877b418f1d59a80d9291e0f091c8"},{"title":"M. Liga de Campeones 3","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:8cc8e3c092fa238bc0cbc65382ae436131fc3eab"},{"title":"DAZN F1 HD","attributes":{"acestream-autosearch":"1","group-title":"sport"},"duration":-1,"url":"magnet:?xt=urn:btih:6d325cda6ed591647ef5e91edd043147bce8be30"}];
    const players = [{"id":"acestream","label":"Ace Stream (engine local)","type":"acestream"},{"id":"vlc","label":"VLC (iOS/macOS)","type":"template","template":"vlc-x-callback://x-callback-url/stream?url={{url}}"},{"id":"infuse","label":"Infuse","type":"template","template":"infuse://x-callback-url/play?url={{url}}"},{"id":"kodi","label":"Kodi","type":"template","template":"kodi://play?item={{url}}"}];
    const playlistContainer = document.getElementById("playlist");
    const searchInput = document.getElementById("search");
    const groupFilter = document.getElementById("group");

    const groups = Array.from(new Set(playlist.map(item => item.attributes["group-title"]).filter(Boolean))).sort();
    for (const group of groups) {
      const option = document.createElement("option");
      option.value = group;
      option.textContent = group;
      groupFilter.appendChild(option);
    }

    function buildPlayerUrl(player, url) {
      if (player.type === "acestream") {
        if (url.startsWith("acestream://")) {
          return url;
        }
        if (url.startsWith("magnet:?xt=urn:btih:")) {
          const hash = url.split("magnet:?xt=urn:btih:")[1];
          return "acestream://" + hash;
        }
        return url;
      }

      if (player.type === "template" && player.template) {
        const encoded = encodeURIComponent(url);
        let result = player.template;
        result = result.split("{{url}}").join(encoded);
        result = result.split("{{url_raw}}").join(url);
        return result;
      }

      return url;
    }

    function render(list) {
      playlistContainer.innerHTML = "";
      if (!list.length) {
        const empty = document.createElement("p");
        empty.textContent = "No hay canales que coincidan con el filtro.";
        playlistContainer.appendChild(empty);
        return;
      }

      for (const item of list) {
        const card = document.createElement("article");
        card.className = "card";
        card.setAttribute("role", "listitem");

        const title = document.createElement("h2");
        title.textContent = item.title || "Canal sin nombre";
        card.appendChild(title);

        const meta = document.createElement("div");
        meta.className = "meta";
        if (item.attributes["group-title"]) {
          const badge = document.createElement("span");
          badge.textContent = item.attributes["group-title"];
          meta.appendChild(badge);
        }
        if (item.attributes["tvg-id"]) {
          const badge = document.createElement("span");
          badge.textContent = "ID: " + item.attributes["tvg-id"];
          meta.appendChild(badge);
        }
        card.appendChild(meta);

        const actions = document.createElement("div");
        actions.className = "actions";

        const button = document.createElement("a");
        button.className = "play";
        button.href = item.url;
        button.textContent = "Reproducir";
        button.target = "_blank";
        button.rel = "noreferrer";
        actions.appendChild(button);

        if (players.length) {
          const picker = document.createElement("details");
          picker.className = "player-picker";
          const summary = document.createElement("summary");
          summary.textContent = "Seleccionar reproductor";
          picker.appendChild(summary);
          const listEl = document.createElement("ul");
          listEl.className = "player-picker__list";

          for (const player of players) {
            const li = document.createElement("li");
            const link = document.createElement("a");
            link.textContent = player.label;
            link.href = buildPlayerUrl(player, item.url);
            link.target = "_blank";
            link.rel = "noreferrer";
            li.appendChild(link);
            listEl.appendChild(li);
          }
          picker.appendChild(listEl);
          actions.appendChild(picker);
        }

        const copyBtn = document.createElement("button");
        copyBtn.type = "button";
        copyBtn.className = "copy";
        copyBtn.textContent = "Copiar enlace";
        copyBtn.addEventListener("click", async () => {
          try {
            await navigator.clipboard.writeText(item.url);
            copyBtn.textContent = "Copiado";
            setTimeout(() => {
              copyBtn.textContent = "Copiar enlace";
            }, 1500);
          } catch (error) {
            copyBtn.textContent = "Error";
            setTimeout(() => {
              copyBtn.textContent = "Copiar enlace";
            }, 1500);
          }
        });
        actions.appendChild(copyBtn);

        const shareBtn = document.createElement("button");
        shareBtn.type = "button";
        shareBtn.className = "share";
        shareBtn.textContent = "Compartir";
        shareBtn.addEventListener("click", async () => {
          const shareData = {
            title: item.title || "Canal AceStream",
            text: item.title || "Canal AceStream",
            url: item.url
          };
          if (navigator.share) {
            try {
              await navigator.share(shareData);
              return;
            } catch (error) {
              console.warn("Share cancelado", error);
            }
          }
          try {
            await navigator.clipboard.writeText(item.url);
            shareBtn.textContent = "Copiado";
            setTimeout(() => {
              shareBtn.textContent = "Compartir";
            }, 1500);
          } catch (error) {
            alert("No se pudo compartir ni copiar este enlace");
          }
        });
        actions.appendChild(shareBtn);

        card.appendChild(actions);
        playlistContainer.appendChild(card);
      }
    }

    function applyFilters() {
      const term = searchInput.value.toLowerCase();
      const group = groupFilter.value;
      const filtered = playlist.filter(item => {
        const matchTerm = term
          ? (item.title && item.title.toLowerCase().includes(term)) ||
            (item.attributes && JSON.stringify(item.attributes).toLowerCase().includes(term))
          : true;
        const matchGroup = group ? item.attributes["group-title"] === group : true;
        return matchTerm && matchGroup;
      });
      render(filtered);
    }

    searchInput.addEventListener("input", applyFilters);
    groupFilter.addEventListener("change", applyFilters);

    render(playlist);
  </script>
</body>
</html>